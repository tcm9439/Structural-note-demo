import{_ as N}from"./_plugin-vue_export-helper.c27b6911.js";import{q as m,s as I,ar as U,i as u,P as w,y as e,x as t,z as n,d as H,r as C,c as z,U as d,e as B,v as _,J as o,M as a,l as $,aM as A,ah as D,S as p,T as O,$ as j,Z as R,m as q,Y as F,t as J}from"./entry.fb632390.js";import{N as M}from"./NoteExportHandler.3336c0aa.js";import{e as P}from"./exception.03807a46.js";const K={},W={class:"mt-layout-header"};function X(h,l){return m(),I("div",W,[U(h.$slots,"default",{},void 0,!0)])}const V=N(K,[["render",X],["__scopeId","data-v-1d61b380"]]);const Z={};function Q(h,l){const s=u("Col"),i=u("Row"),r=V;return m(),w(r,null,{default:e(()=>[t(i,{justify:"center",class:"mt-layout-title"},{default:e(()=>[t(s,null,{default:e(()=>[n(" Structural Note ")]),_:1})]),_:1})]),_:1})}const ee=N(Z,[["render",Q],["__scopeId","data-v-f7901e1b"]]),te=H({__name:"note",setup(h){const{$viewState:l,$emitter:s}=$(),i=C(l.editing_note_name),r=z(()=>l.editing_note!=null),x=C(0);async function E(){const{$Modal:y,$viewState:b}=$();let v=async()=>{let f=j.getPageRoute(R.SETTING);O.logger.debug(`Navigate to setting page: ${f}`),await q(f)};b.isNoteChange()?await y.confirm({title:a("common.save_confirm_window.title",null,{target:a("structural.file.note")}),content:a("structural.setting.save_before.content"),okText:a("common.save_confirm_window.save"),onOk:async()=>{try{await p.saveNote(),O.logger.debug("Note saved before setting update."),v()}catch(f){P(f)}},cancelText:a("common.cancel")}):v()}async function T(y){try{switch(y){case"new-window":await p.createNote();break;case"open-file":await p.openNote();break;case"close-file":r.value&&await p.closeNote();break;case"save-file":r.value&&await p.saveNote();break;case"save-as-file":r.value&&await p.saveNote(!0);break;case"export-md":r.value&&await M.emitShowConvertPreviewEvent(D.MARKDOWN);break;case"export-txt":r.value&&await M.emitShowConvertPreviewEvent(D.TEXT);break;case"setting":r.value&&await E();break;case"undo":A.undo();break;case"redo":A.redo();break}}catch(b){P(b)}x.value++}function g(){k()}function k(){i.value=l.editing_note_name}return s.on(d.NOTE_OPENED,g),s.on(d.NOTE_CLOSED,g),s.on(d.NOTE_SAVED,k),B(()=>{s.off(d.NOTE_OPENED,g),s.off(d.NOTE_CLOSED,g),s.off(d.NOTE_SAVED,k)}),(y,b)=>{const v=u("Col"),f=u("Row"),c=u("MenuItem"),L=u("MenuGroup"),S=u("Submenu"),G=u("Menu"),Y=V;return m(),w(Y,null,{default:e(()=>[t(f,null,{default:e(()=>[t(v,{class:"mt-layout-note-title"},{default:e(()=>[n(_(o(i)),1)]),_:1})]),_:1}),(m(),w(f,{class:"mt-layout-toolbar",key:o(x)},{default:e(()=>[t(v,{class:"mt-layout-toolbar"},{default:e(()=>[t(G,{mode:"horizontal",onOnSelect:T},{default:e(()=>[t(S,{name:"file-operation"},{title:e(()=>[n(_(o(a)("structural.header.file_menu")),1)]),default:e(()=>[t(c,{name:"open-file"},{default:e(()=>[n(_(o(a)("structural.header.file_open")),1)]),_:1}),t(c,{name:"close-file"},{default:e(()=>[n(_(o(a)("structural.header.file_close")),1)]),_:1}),t(c,{name:"save-file"},{default:e(()=>[n(_(o(a)("structural.header.file_save")),1)]),_:1}),t(c,{name:"save-as-file"},{default:e(()=>[n(_(o(a)("structural.header.file_save_as")),1)]),_:1}),t(L,{title:o(a)("structural.header.file_export_submenu")},{default:e(()=>[t(c,{name:"export-md"},{default:e(()=>[n(_(o(a)("structural.header.file_export_md")),1)]),_:1}),t(c,{name:"export-txt"},{default:e(()=>[n(_(o(a)("structural.header.file_export_txt")),1)]),_:1})]),_:1},8,["title"])]),_:1}),t(S,{name:"edit-operation"},{title:e(()=>[n(_(o(a)("structural.header.edit_menu")),1)]),default:e(()=>[t(c,{name:"undo"},{default:e(()=>[n(_(o(a)("structural.header.edit_undo")),1)]),_:1}),t(c,{name:"redo"},{default:e(()=>[n(_(o(a)("structural.header.edit_redo")),1)]),_:1})]),_:1}),t(S,{name:"window-operation"},{title:e(()=>[n(_(o(a)("structural.header.window_menu")),1)]),default:e(()=>[t(c,{name:"new-window"},{default:e(()=>[n(_(o(a)("structural.header.window_new")),1)]),_:1})]),_:1}),t(c,{name:"setting"},{default:e(()=>[n(_(o(a)("structural.header.setting_menu")),1)]),_:1})]),_:1})]),_:1})]),_:1}))]),_:1})}}});const ae=N(te,[["__scopeId","data-v-07cb12bf"]]),oe={class:"layout"},ne={class:"content"},_e=H({__name:"default",setup(h){const{$emitter:l}=$(),s=C("note");function i(r){switch(O.logger.trace("Update header layout to "+r),r){case R.SETTING:s.value="none";break;default:s.value="note";break}}return l.on(d.LAYOUT_UPDATE,i),B(()=>{l.off(d.LAYOUT_UPDATE,i)}),(r,x)=>{const E=ee,T=ae;return m(),I("div",oe,[o(s)=="none"?(m(),w(E,{key:0})):o(s)=="note"?(m(),w(T,{key:1})):F("",!0),J("div",ne,[U(r.$slots,"default",{},void 0,!0)])])}}});const ue=N(_e,[["__scopeId","data-v-2573a81f"]]);export{ue as default};
